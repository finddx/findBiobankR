---
title: "biobank-reports"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{biobank-reports}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(findBiobankR)
```

<!-- WARNING - This vignette is generated by {fusen} from dev/biobank_reports.Rmd: do not edit by hand -->

<!--
 You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.
-->


# data_table

    

  
  

```{r example-data_table}
 data("iris")
df = iris[1:10,]

data_table(df, 
           file_name = "iris_sub_df")
```

 
  

  

# read_multiple_sheets

    

  
  

```{r example-read_multiple_sheets}
iris_species <- system.file("extdata", "iris_species.xlsx",
                          package = "findBiobankR")

iris_list <- read_multiple_sheets(file_path  = iris_species ) %>% 
  lapply(head, 4)
iris_list
```

  

# any_pos_any_neg

    

```{r example-any_pos_any_neg}
data("tb_resp_symptoms")

respirotory_symptoms <- c("COUGH", "EXPECTORATION",
                          "HEMOPTYSIS", "CHEST_PAIN",
                          "DYSPNOE")

any_pos_any_neg(df = tb_resp_symptoms, 
                 test_cols =respirotory_symptoms ,
                 test_type = "resp_symp" ,
                 neg_value ="No",
                 pos_value = "Yes",
                 id_cols ="ID")
```

# rm_all_na_col

    

  

```{r example-rm_all_na_col}
library(data.table)

# Create a data frame with missing values.
df <- data.table(
  id = 1:10,
  name = c("John", "Jane", "", "Mary", "Mike", "", "", "Peter", "Sam", "Susan"),
  age = c(20, 21, 18, 22, 23, 19, NA, 24, 25, 26),
  height = c(170, 160, 180, 175, 185, 175, NA, 190, 195, 200),
  plasma_collected = rep(NA, 10)
)

# Remove columns with more than 99% missing values.
rm_all_na_col(df, missing_perc = 99.99)
```

  

  

# read_multiple_files

    

  

```{r example-read_multiple_files}
library(data.table)
iris_split <- split(iris, 
                    f = iris$Species)


path_name <- tempfile(pattern = "read_multipe_files") %>%
    normalizePath(winslash = "/")

dir.create(path_name)
file_names <- paste0(names(iris_split),  ".csv")
# create file name
file_paths <- file.path(path_name, file_names)
lapply(seq_along(file_paths), function(x){
    df = iris_split[[x]]
    fwrite(df, file = file_paths[x])
})

read_multiple_files(folder_path =path_name ,
                    read_function = "fread",
                    pattern = ".csv$",
                    file_names =NULL)
#file.remove(file_name)
unlink(path_name)
```

# summarise_categorical_vars

    

  

```{r example-summarise_categorical_vars}
data("tb_data", package = "findBiobankR")
summarise_categorical_vars(df = tb_data,
                           by_vec = c("tb_group", "country"),
                           names_from_var ="country",
                           setordr_col = "tb_group",
                           names_from_sort =NULL ,
                           return_wide = TRUE,
                           add_totals_where = c("row", "col"))
```

  

  

# get_find_study_id

    

  

```{r example-get_find_study_id}

ppid <- c("TB002133530", "TB032020154",
          "TB001200533", "TB001035037", 
          "TB002133927")
study_id <- get_find_study_id(ppid)

```

  

  
  

# get_site_id

    

  

```{r example-get_site_id}
get_site_id("PP007019990")
```

  

  

# get_event_id

    

  

```{r example-get_event_id}

get_event_id("PP0070199910001001")

```

  

  

  

# get_specimen_type_id

    

  

```{r example-get_specimen_type_id}

get_specimen_type_id("PP0070199910001001")

```

  

  

# get_aliquot_number

    

  

```{r example-get_aliquot_number}

get_aliquot_number("PP0070199910001001")


```

  

  

# get_patient_id

    

  

```{r example-get_patient_id}

get_patient_id("PP0070199910001001")

```

  

  


